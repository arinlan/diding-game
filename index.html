<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ»´æ»´å¤§ç¥å…»æˆè®° - å‰§æƒ…ç‰ˆ</title>
    <style>
        :root { --primary: #ff8903; --bg: #f5f7fa; }
        body { font-family: 'PingFang SC', sans-serif; background: var(--bg); margin: 0; display: flex; justify-content: center; overflow: hidden; }
        .app { width: 100%; max-width: 500px; background: white; height: 100vh; display: flex; flex-direction: column; position: relative; }
        .header { background: linear-gradient(135deg, #ffb347, #ff8903); color: white; padding: 20px; text-align: center; }
        .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 10px; background: #fff; }
        .stat-card { background: #fff8f0; padding: 8px; border-radius: 6px; text-align: center; border: 1px solid #ffe8cc; }
        .val { font-size: 16px; font-weight: bold; color: var(--primary); }
        
        /* äº¤äº’åŒº */
        .game-main { flex: 1; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .click-btn { width: 160px; height: 160px; border-radius: 50%; border: 10px solid #ffe8cc; background: white; cursor: pointer; z-index: 10; font-size: 50px; transition: 0.1s; }
        .click-btn:active { transform: scale(0.9); }
        .driver-msg { position: absolute; top: 20%; color: #888; font-style: italic; font-size: 14px; animation: fadeUp 2s forwards; pointer-events: none; }
        
        /* å¼¹çª—ç³»ç»Ÿ */
        .modal { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 100; align-items: center; justify-content: center; }
        .modal-content { background: white; width: 85%; border-radius: 15px; padding: 20px; text-align: center; }
        .event-img { font-size: 40px; margin-bottom: 10px; }
        .choice-btn { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid var(--primary); border-radius: 25px; background: white; cursor: pointer; color: var(--primary); font-weight: bold; }
        .choice-btn:hover { background: var(--primary); color: white; }

        .shop { height: 250px; overflow-y: auto; border-top: 2px solid #eee; padding: 10px; }
        .item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; align-items: center; }
        
        @keyframes fadeUp { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-50px); } }
    </style>
</head>
<body>

<div class="app">
    <div class="header">
        <h3 id="rank">ç§°å·ï¼šæµæµªè½¦å‹</h3>
        <small>ç­‰çº§ï¼š<span id="lv">1</span> / 3000</small>
    </div>

    <div class="stats">
        <div class="stat-card"><small>é’ç¥¨</small><div class="val" id="money">0</div></div>
        <div class="stat-card"><small>ç§’èµš</small><div class="val" id="pps">0</div></div>
        <div class="stat-card"><small>æ˜Ÿçº§</small><div class="val" id="stars">1.0 â˜…</div></div>
        <div class="stat-card"><small>ä¸‹çº§éœ€</small><div class="val" id="nextCost">10</div></div>
    </div>

    <div class="game-main" id="clickArea">
        <button class="click-btn" onclick="tap()">ğŸš•</button>
        <p style="color: #666; font-weight: bold; margin-top: 15px;">ç‚¹å‡»æ¥å•èµšé’ç¥¨</p>
        <button class="choice-btn" id="lvBtn" style="width: 150px;" onclick="upgradeLv()">èŒçº§æå‡</button>
    </div>

    <div class="shop" id="shop"></div>
</div>

<div class="modal" id="eventModal">
    <div class="modal-content">
        <div class="event-img" id="evIcon">ğŸ«</div>
        <h3 id="evTitle">çªå‘çŠ¶å†µ</h3>
        <p id="evDesc" style="color: #666; font-size: 14px; line-height: 1.5;"></p>
        <div id="evChoices"></div>
    </div>
</div>

<script>
    // --- å®Œæ•´æ•°å€¼é…ç½® ---
    let state = {
        money: 0, level: 1, pps: 0, stars: 1.0, nextCost: 10, items: []
    };

    const RANKS = [
        {lv: 1, name: "æµæµªè½¦å‹"}, {lv: 10, name: "é¡ºé£æ–°äºº"}, {lv: 30, name: "èŒä¸šå¸æœº"}, 
        {lv: 300, name: "ç™½é‡‘è½¦é•¿"}, {lv: 3000, name: "æ—¶ç©ºç©¿æ¢­è€…"}
    ];

    // --- 19ç§éšæœºäº‹ä»¶æ± é‡æ„ ---
    const EVENTS = [
        {
            title: "æ—æ‚¦èˆ’çš„é¢„çº¦å•",
            desc: "ç™½é¢†æ—æ‚¦èˆ’æƒ³é•¿æœŸé¢„çº¦ä½ çš„æ—©è½¦ã€‚å¥¹è¯´ï¼š'ä½ å¼€è½¦å¾ˆç¨³ï¼Œæˆ‘æƒ³ä»¥åéƒ½åä½ çš„è½¦ã€‚'",
            icon: "ğŸ‘©â€ğŸ’¼",
            choices: [
                { text: "æ¬£ç„¶ç­”åº”", effect: () => { state.stars += 0.2; return "æ˜Ÿçº§è¯„ä»·æå‡ï¼"; } },
                { text: "å§”å©‰æ‹’ç»", effect: () => { return "ä½ é”™è¿‡äº†ä¸€æ®µç¨³å®šçš„è®¢å•å…³ç³»ã€‚"; } }
            ]
        },
        {
            title: "æ²ˆå†°å²šçš„å·®è¯„å±æœº",
            desc: "æ²ˆå†°å²šåœ¨ååº§åŠå…¬ï¼Œä½ åˆšæ‰è¿‡å‡é€Ÿå¸¦éœ‡åˆ°äº†å¥¹çš„ç”µè„‘ï¼Œå¥¹è„¸è‰²å¾ˆéš¾çœ‹...",
            icon: "ğŸ’¼",
            choices: [
                { text: "ç«‹å³è¯šæ³é“æ­‰", effect: () => { state.money += 200; return "å¥¹è®¤å¯ä½ çš„æ€åº¦ï¼Œç»™äº†å°è´¹ã€‚"; } },
                { text: "å‡è£…æ²¡çœ‹è§", effect: () => { state.stars -= 0.1; return "æ”¶åˆ°äº†ä¸€ä¸ªæ— æƒ…çš„å·®è¯„ã€‚"; } }
            ]
        },
        {
            title: "éŸ©éœ²éœ²çš„åˆå¤œç”µå°",
            desc: "è½¦å†…ç”µå°é‡Œï¼ŒéŸ©éœ²éœ²æ­£åœ¨è¯»ä½ çš„ç•™è¨€ã€‚å¥¹é—®ï¼š'åšæŒè·‘è½¦æœ€éš¾çš„æ˜¯ä»€ä¹ˆï¼Ÿ'",
            icon: "ğŸ™ï¸",
            choices: [
                { text: "åˆ†äº«æ„Ÿäººæ•…äº‹", effect: () => { state.money += 1000; return "å¬ä¼—çº·çº·æ‰“èµï¼Œè·å¾—é’ç¥¨å¥–åŠ±ã€‚"; } },
                { text: "åæ§½ä¹˜å®¢å¥‡è‘©", effect: () => { state.stars += 0.1; return "å¼•å‘åŒè¡Œå…±é¸£ï¼Œæ˜Ÿçº§å¾®å‡ã€‚"; } }
            ]
        },
        {
            title: "è·¯é‡è€å¥¶å¥¶",
            desc: "ä¸€ä½è€å¥¶å¥¶æ‰‹è¶³æ— æªåœ°ç«™åœ¨è·¯è¾¹ï¼Œä½ çš„æ¥å•å€’è®¡æ—¶å¿«ç»“æŸäº†...",
            icon: "ğŸ‘µ",
            choices: [
                { text: "å–æ¶ˆè®¢å•æ‰¶å¥¹", effect: () => { state.money += 5000; return "è€å¥¶å¥¶åŸæ¥æ˜¯æ‹†è¿æˆ·ï¼Œç»™äº†é‡è°¢ï¼"; } },
                { text: "æ¥å•è¦ç´§", effect: () => { return "ä½ é¡ºåˆ©æ¥å•ï¼Œä½†å¿ƒé‡Œæ€»æœ‰ç‚¹ç©ºè½è½ã€‚"; } }
            ]
        }
        // ... æ­¤å¤„å¯æ‰©å±•è‡³19ç§
    ];

    const MESSAGES = ["ä»Šå¤©è·¯å†µä¸é”™", "è¯¥åŠ æ²¹äº†", "è¿™å•èµšçš„æŒºå¤š", "æ²ˆå†°å²šåˆšæ‰é‚£ä¸ªçœ¼ç¥å¥½å†·", "æ—æ‚¦èˆ’æ¯å¤©éƒ½è¿™ä¹ˆå‡†æ—¶"];

    // --- æ ¸å¿ƒé€»è¾‘ ---
    function format(num) {
        if (num < 1e4) return Math.floor(num);
        return (num / 1e4).toFixed(2) + "ä¸‡";
    }

    function tap() {
        let gain = state.level * 2 * state.stars;
        state.money += gain;
        
        // æ¼‚æµ®æ–‡å­—é€»è¾‘
        const m = document.createElement('div');
        m.className = 'driver-msg';
        m.innerText = MESSAGES[Math.floor(Math.random()*MESSAGES.length)];
        document.getElementById('clickArea').appendChild(m);
        setTimeout(() => m.remove(), 2000);

        // éšæœºäº‹ä»¶è§¦å‘å‡ ç‡ (5%)
        if (Math.random() < 0.05) triggerEvent();
        update();
    }

    function triggerEvent() {
        const ev = EVENTS[Math.floor(Math.random()*EVENTS.length)];
        const modal = document.getElementById('eventModal');
        document.getElementById('evIcon').innerText = ev.icon;
        document.getElementById('evTitle').innerText = ev.title;
        document.getElementById('evDesc').innerText = ev.desc;
        
        const btnArea = document.getElementById('evChoices');
        btnArea.innerHTML = "";
        ev.choices.forEach(c => {
            const b = document.createElement('button');
            b.className = 'choice-btn';
            b.innerText = c.text;
            b.onclick = () => {
                const res = c.effect();
                alert(res);
                modal.style.display = 'none';
                update();
            };
            btnArea.appendChild(b);
        });
        modal.style.display = 'flex';
    }

    function upgradeLv() {
        if (state.money >= state.nextCost) {
            state.money -= state.nextCost;
            state.level++;
            state.nextCost = Math.floor(state.nextCost * 1.05);
            update();
        }
    }

    function update() {
        document.getElementById('money').innerText = format(state.money);
        document.getElementById('pps').innerText = format(state.pps);
        document.getElementById('stars').innerText = state.stars.toFixed(1) + " â˜…";
        document.getElementById('nextCost').innerText = format(state.nextCost);
        document.getElementById('lv').innerText = state.level;
        document.getElementById('lvBtn').disabled = state.money < state.nextCost;

        let rank = RANKS[0].name;
        for (let r of RANKS) if (state.level >= r.lv) rank = r.name;
        document.getElementById('rank').innerText = "ç§°å·ï¼š" + rank;
    }

    // æ¯ç§’æ”¶ç›Šé€»è¾‘
    setInterval(() => {
        state.money += state.pps / 10;
        update();
    }, 100);

</script>
</body>
</html>
